{"version":3,"sources":["assets/Script/Joystick/Joystick.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\nimport JoystickBg from \"./JoystickBg\";\nimport JoystickCenter from \"./JoystickCenter\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class Joystick extends cc.Component {\n\n    @property(JoystickBg)\n    bg: JoystickBg = null;\n\n    @property(JoystickCenter)\n    center: JoystickCenter = null;\n\n    private _enabledRunning: boolean = false; \n\n    public set enabledRunning(enabledRunning: boolean) {\n        this._enabledRunning = enabledRunning;\n    }\n\n    public get enabledRunning() {\n        return this._enabledRunning;\n    }\n\n    start () {\n\n    }\n\n    protected onLoad(): void {\n        this.registerEvent();\n        this._enabledRunning = true;\n    }\n\n    private registerEvent(): void {\n        this.node.on(cc.Node.EventType.TOUCH_START, this.onTouchStart, this);\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\n        this.node.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this);\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, this.onTouchEnd, this);\n    }\n\n    private onTouchStart(event: cc.Event.EventTouch): void {\n        if (this.enabledRunning) {\n            const pos = this.node.convertToNodeSpaceAR(event.getLocation());\n            this.bg.node.setPosition(pos);\n            this.center.node.setPosition(pos);\n        }\n    }\n\n    private onTouchMove(event: cc.Event.EventTouch): void {\n        if (this.enabledRunning) {\n            const pos = this.center.node.position.add(cc.v3(event.getDelta()));\n            this.center.node.setPosition(pos);\n            const r = this.bg.radius - this.center.radius;\n            if (cc.Vec2.distance(pos, this.bg.node.position) > r) {\n                const p = this.node.convertToNodeSpaceAR(event.getLocation());\n                const v = p.sub(this.bg.node.getPosition()).normalize().mul(r);\n                this.center.node.setPosition(this.bg.node.position.add(cc.v3(v)));\n            }\n        }\n    }\n\n    private onTouchEnd(event: cc.Event.EventTouch): void {\n        this.bg.node.setPosition(cc.v2(0, 0));\n        this.center.node.setPosition(cc.v2(0, 0));\n    }\n\n    // update (dt) {}\n}\n"]}